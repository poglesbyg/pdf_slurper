<!DOCTYPE html>
<html>
<head>
    <title>Dashboard Test</title>
</head>
<body>
    <h1>Dashboard Data Test</h1>
    <div id="results"></div>
    
    <script>
        async function testDashboard() {
            const results = document.getElementById('results');
            
            try {
                // Fetch statistics
                const statsResponse = await fetch('http://localhost:8080/api/v1/submissions/statistics');
                const stats = await statsResponse.json();
                
                // Fetch recent submissions
                const submissionsResponse = await fetch('http://localhost:8080/api/v1/submissions/?limit=10');
                const submissionsData = await submissionsResponse.json();
                const recentSubmissions = submissionsData.items || [];
                
                // Display results
                results.innerHTML = `
                    <h2>API Data Retrieved Successfully!</h2>
                    <h3>Statistics:</h3>
                    <ul>
                        <li>Total Submissions: <strong>${stats.total_submissions}</strong></li>
                        <li>Total Samples: <strong>${stats.total_samples}</strong></li>
                        <li>Samples Received: <strong>${stats.workflow_status?.received || 0}</strong></li>
                        <li>Samples Processing: <strong>${stats.workflow_status?.processing || 0}</strong></li>
                        <li>Samples Pending: <strong>${stats.workflow_status?.pending || 0}</strong></li>
                        <li>QC Pending: <strong>${stats.qc_status?.pending || 0}</strong></li>
                        <li>QC Passed: <strong>${stats.qc_status?.passed || 0}</strong></li>
                        <li>Average Quality Score: <strong>${stats.average_quality_score?.toFixed(1) || 'N/A'}</strong></li>
                    </ul>
                    <h3>Recent Submissions:</h3>
                    <ul>
                        ${recentSubmissions.map(sub => `
                            <li>${sub.id.substring(0, 12)}... - ${sub.metadata?.identifier || 'N/A'} (${sub.sample_count} samples)</li>
                        `).join('')}
                    </ul>
                    <p style="color: green; font-weight: bold;">âœ“ All data loaded successfully!</p>
                    <p>Now visit <a href="http://localhost:3000" target="_blank">http://localhost:3000</a> to see the dashboard.</p>
                `;
                
                console.log('Dashboard data loaded:', {
                    stats,
                    recentSubmissions: recentSubmissions.length
                });
                
            } catch (error) {
                results.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                console.error('Dashboard test error:', error);
            }
        }
        
        // Run test on page load
        testDashboard();
    </script>
</body>
</html>
